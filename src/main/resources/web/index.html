<!DOCTYPE html>
<html>
    <head>
        <style>
            .a {
            width: 220px;
            height: 220px;
            margin: 10px;
            float: left;
            background: black;
            }
            .b {
            width: 120px;
            height: 320px;
            margin: 10px;
            float: left;
            background: red;
            }
        </style>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <title>MaylinCraft Newsfeed</title>
        <meta name="generator" content="Bootply" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <!--[if lt IE 9]>
        <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <link href="css/styles.css" rel="stylesheet">
        <style>
            .nf-login-heading-online {
            background: -webkit-linear-gradient(black, #5ad137); /* For Safari 5.1 to 6.0 */
            background: -o-linear-gradient(black, #5ad137); /* For Opera 11.1 to 12.0 */
            background: -moz-linear-gradient(black, #5ad137); /* For Firefox 3.6 to 15 */
            background: linear-gradient(black, #5ad137); /* Standard syntax */
            }
            .nf-login-heading-offline {
            background: -webkit-linear-gradient(#5ad137, black); /* For Safari 5.1 to 6.0 */
            background: -o-linear-gradient(#5ad137, black); /* For Opera 11.1 to 12.0 */
            background: -moz-linear-gradient(#5ad137, black); /* For Firefox 3.6 to 15 */
            background: linear-gradient(#5ad137, black); /* Standard syntax */
            }
            .nf-login-panel {
            width:267px;
            height:243px;
            float: left;
            }
            .nf-death-panel {
            width:534px;
            height:329px;
            float: left;
            }
            .nf-diamond-panel {
            width:534px;
            height:331px;
            float: left;
            }
            .nf-mcmmo-levelup-panel {
            width:534px;
            height:364px;
            float: left;
            }
            .nf-death-heading {
            background: -webkit-linear-gradient(red, black); /* For Safari 5.1 to 6.0 */
            background: -o-linear-gradient(red, black); /* For Opera 11.1 to 12.0 */
            background: -moz-linear-gradient(red, black); /* For Firefox 3.6 to 15 */
            background: linear-gradient(red, black); /* Standard syntax */
            }
            .nf-diamond-heading {
            background: -webkit-linear-gradient(#81bfbc, #192474); /* For Safari 5.1 to 6.0 */
            background: -o-linear-gradient(#81bfbc, #192474); /* For Opera 11.1 to 12.0 */
            background: -moz-linear-gradient(#81bfbc, #192474); /* For Firefox 3.6 to 15 */
            background: linear-gradient(#81bfbc, #192474); /* Standard syntax */
            }
            .nf-mcmmo-levelup-heading {
            background: -webkit-linear-gradient(orange, black); /* For Safari 5.1 to 6.0 */
            background: -o-linear-gradient(orange, black); /* For Opera 11.1 to 12.0 */
            background: -moz-linear-gradient(orange, black); /* For Firefox 3.6 to 15 */
            background: linear-gradient(orange, black); /* Standard syntax */
            }
            h6 {
            color: white;
            }
            .panel-heading {
            border: 0;
            padding: 3px 13px;
            }
            h3 {
            margin-top: 0px;
            }
            .nf-time {
            color: grey;
            }
            .nf-list-group {
            height: 115px;
            }
            .death-item {
            background: #333;
            text-align: center;
            height: 288px !important;
            width: 100%;
            }
            .death-panel-body {
            padding: 0;
            }
        </style>
    </head>
    <body>
        <nav class="navbar navbar-fixed-top header">
            <div class="col-md-12">
                <div class="navbar-header">
                    <a href="#" class="navbar-brand">Bootstrap</a>
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse1">
                    <i class="glyphicon glyphicon-search"></i>
                    </button>
                </div>
                <div class="collapse navbar-collapse" id="navbar-collapse1">
                    <form class="navbar-form pull-left">
                        <div class="input-group" style="max-width:470px;">
                            <input type="text" class="form-control" placeholder="Search" name="srch-term" id="srch-term">
                            <div class="input-group-btn">
                                <button class="btn btn-default btn-primary" type="submit"><i class="glyphicon glyphicon-search"></i></button>
                            </div>
                        </div>
                    </form>
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="http://www.bootply.com" target="_ext">Bootply+</a></li>
                        <li>
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="glyphicon glyphicon-bell"></i></a>
                            <ul class="dropdown-menu">
                                <li><a href="#"><span class="badge pull-right">40</span>Link</a></li>
                                <li><a href="#"><span class="badge pull-right">2</span>Link</a></li>
                                <li><a href="#"><span class="badge pull-right">0</span>Link</a></li>
                                <li><a href="#"><span class="label label-info pull-right">1</span>Link</a></li>
                                <li><a href="#"><span class="badge pull-right">13</span>Link</a></li>
                            </ul>
                        </li>
                        <li><a href="#" id="btnToggle"><i class="glyphicon glyphicon-th-large"></i></a></li>
                        <li><a href="#"><i class="glyphicon glyphicon-user"></i></a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <div class="navbar navbar-default" id="subnav">
            <div class="col-md-12">
                <div class="navbar-header">
                    <a href="#" style="margin-left:15px;" class="navbar-btn btn btn-default btn-plus dropdown-toggle" data-toggle="dropdown"><i class="glyphicon glyphicon-home" style="color:#dd1111;"></i> Home <small><i class="glyphicon glyphicon-chevron-down"></i></small></a>
                    <ul class="nav dropdown-menu">
                        <li><a href="#"><i class="glyphicon glyphicon-user" style="color:#1111dd;"></i> Profile</a></li>
                        <li><a href="#"><i class="glyphicon glyphicon-dashboard" style="color:#0000aa;"></i> Dashboard</a></li>
                        <li><a href="#"><i class="glyphicon glyphicon-inbox" style="color:#11dd11;"></i> Pages</a></li>
                        <li class="nav-divider"></li>
                        <li><a href="#"><i class="glyphicon glyphicon-cog" style="color:#dd1111;"></i> Settings</a></li>
                        <li><a href="#"><i class="glyphicon glyphicon-plus"></i> More..</a></li>
                    </ul>
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse2">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    </button>
                </div>
                <div class="collapse navbar-collapse" id="navbar-collapse2">
                    <ul class="nav navbar-nav navbar-right">
                        <li class="active"><a href="#">Posts</a></li>
                        <li><a href="#loginModal" role="button" data-toggle="modal">Login</a></li>
                        <li><a href="#aboutModal" role="button" data-toggle="modal">About</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <!--main-->
        <div class="container" id="main">
            <div id="nf-row" class="row"></div>
            <!--/row-->
            <div class="clearfix"></div>
            <hr>
            <div class="col-md-12 text-center">
                <p><a href="http://www.bootply.com/download/90113" target="_ext">Download Google Plus Style Template</a><br><a href="http://bootply.com/templates" target="_ext">More Bootstrap Templates by @Bootply</a></p>
            </div>
            <hr>
        </div>
        <!--/main-->
        <!--login modal-->
        <div id="loginModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                        <h2 class="text-center"><img src="https://lh5.googleusercontent.com/-b0-k99FZlyE/AAAAAAAAAAI/AAAAAAAAAAA/eu7opA4byxI/photo.jpg?sz=100" class="img-circle"><br>Login</h2>
                    </div>
                    <div class="modal-body">
                        <form class="form col-md-12 center-block">
                            <div class="form-group">
                                <input type="text" class="form-control input-lg" placeholder="Email">
                            </div>
                            <div class="form-group">
                                <input type="password" class="form-control input-lg" placeholder="Password">
                            </div>
                            <div class="form-group">
                                <button class="btn btn-primary btn-lg btn-block">Sign In</button>
                                <span class="pull-right"><a href="#">Register</a></span><span><a href="#">Need help?</a></span>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <div class="col-md-12">
                            <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--about modal-->
        <div id="aboutModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                        <h2 class="text-center">About</h2>
                    </div>
                    <div class="modal-body">
                        <div class="col-md-12 text-center">
                            <a href="http://www.bootply.com/DwnjTNuvVt">This Bootstrap Template</a><br>was made with <i class="glyphicon glyphicon-heart"></i> by <a href="http://bootply.com/templates">Bootply</a>
                            <br><br>
                            <a href="https://github.com/iatek/bootstrap-google-plus">GitHub Fork</a>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn" data-dismiss="modal" aria-hidden="true">OK</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- script references -->
        <script src="js/jquery-2.1.1.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/scripts.js"></script>
        <script src="js/jquery.shuffle.js"></script>
        <script src="js/moment.js"></script>
        <script type="text/javascript">
            var startIndex, endIndex, delayTimer;
            
            document.addEventListener('scroll', function (event) {
                if (document.body.scrollHeight == 
                    document.body.scrollTop +        
                    window.innerHeight) {
                    
                    startIndex = endIndex;
                    endIndex += 16;
                    addStories(startIndex, endIndex);
                }
            });            
            
            function getLoginPanelElement(val) {
            
                var snip = '';
            
                snip += '<div class="panel panel-default nf-login-panel">';
                snip += '   <div class="panel-heading nf-replace-class">';
                snip += '      <img src="https://minotar.net/avatar/nf-replace-name/28" class="pull-right">';
                snip += '      <h6>nf-replace-header</h6>';
                snip += '   </div>';
                snip += '   <div>';
                snip += '     <img class="img-responsive" src="images/nf-replace-image"/>';
                snip += '   </div>';
                snip += '   <div class="panel-body">';
                snip += '      <h3><i>nf-replace-name</i></h3>';
                snip += '      <p class="nf-time"><i>nf-replace-time nf-replace-length-descriptor</i></p>';
                snip += '   </div>';
                snip += '</div>';

                var lengthDesc;
                if(parseInt(val.play_time_minutes) > 60) {
                    lengthDesc = "for 1+ hours";
                } else  {
                    lengthDesc = "for " + val.play_time_minutes + " minutes";
                }
                snip = snip.replace(/nf-replace-length-descriptor/g, lengthDesc);

                snip = snip.replace(/nf-replace-name/g, val.name);
            
                if(val.is_online == true) {
                    snip = snip.replace(/nf-replace-header/g, "Online Now");
                    snip = snip.replace(/nf-replace-class/g, "nf-login-heading-online");
                    snip = snip.replace(/nf-replace-image/g, "dpick.jpg");
                } else {
                    snip = snip.replace(/nf-replace-header/g, "Logged In");
                    snip = snip.replace(/nf-replace-class/g, "nf-login-heading-offline");
                    snip = snip.replace(/nf-replace-image/g, "creeperlove.jpg");
                }
            
                snip = snip.replace(/nf-replace-time/g, moment(val.login_time).calendar());
            
                return $.parseHTML(snip);
            }
            
            function getDeathPanelElement(val) {

                // Get the number of deaths for this panel.
                var deathCount = parseInt(val.death_count), i;
                var itemSnip;
            
                var snip = '';

                snip += '<div class="panel panel-default nf-death-panel">';
                snip += '   <div class="panel-heading nf-death-heading">';
                snip += '      <img src="https://minotar.net/avatar/' + val.name + '/32" class="pull-right">';
                snip += '      <h6>Killed in Action</h6>';
                snip += '   </div>';
                snip += '   <div class="death-panel-body panel-body">';
                snip += '      <div id="nf-replace-carousel-id" class ="carousel slide" data-interval="3000" data-ride="carousel">';
                snip += '         <!-- Carousel indicators -->';
                snip += '         <ol class="carousel-indicators">';
                
                for(i = 0 ; i < deathCount ; ++i) {
                    if(i == 0) {
                        snip += '    <li data-target="#nf-replace-carousel-id" data-slide-to="0" class="active"></li>';
                    } else {
                        snip += '    <li data-target="#nf-replace-carousel-id" data-slide-to="' + i + '"></li>';
                    }
                }

                snip += '         </ol>';
                snip += '         <!-- Carousel items -->';
                snip += '         <div class="carousel-inner">';

                for(i = 0 ; i < deathCount ; ++i) {

                    itemSnip ='';

                    if(i == 0) {
                        itemSnip += '<div class="active item death-item">';
                        itemSnip += '   <img class="img-responsive" src="images/skeleowned.jpg"/>';
                        itemSnip += '   <div class="carousel-caption">';
                        itemSnip += '      <h3>nf-replace-cause</h3>';
                        itemSnip += '      <p>nf-replace-death-message</p>';
                        itemSnip += '      <p>nf-replace-time</p>';
                        itemSnip += '   </div>';
                        itemSnip += '</div>';
                    } else {
                        itemSnip += '<div class="item death-item">';
                        itemSnip += '   <img class="img-responsive" src="images/skeleowned.jpg"/>';
                        itemSnip += '   <div class="carousel-caption">';
                        itemSnip += '      <h3>nf-replace-cause</h3>';
                        itemSnip += '      <p>nf-replace-death-message</p>';
                        itemSnip += '      <p>nf-replace-time</p>';
                        itemSnip += '   </div>';
                        itemSnip += '</div>';
                    }

                    itemSnip = itemSnip.replace(/nf-replace-name/g, val.name);
            
                    itemSnip = itemSnip.replace(/nf-replace-cause/g, getDescriptiveCauseOfDeath(val.deaths[i]));
                    itemSnip = itemSnip.replace(/nf-replace-death-message/g, val.deaths[i].death_message);
                    itemSnip = itemSnip.replace(/nf-replace-time/g, moment(val.deaths[i].time).calendar());

                    snip += itemSnip;
                }

                snip += '         </div>';
                snip += '         <!-- Carousel nav -->';
                snip += '         <a class="carousel-control left" href="#nf-replace-carousel-id" data-slide="prev">';
                snip += '            <span class="glyphicon glyphicon-chevron-left"></span>';
                snip += '         </a>';
                snip += '         <a class="carousel-control right" href="#nf-replace-carousel-id" data-slide="next">';
                snip += '            <span class="glyphicon glyphicon-chevron-right"></span>';
                snip += '         </a>';
                snip += '      </div>';
                snip += '   </div>';
                snip += '</div>';

                snip = snip.replace(/nf-replace-carousel-id/g, Math.floor(Math.random() * 100000));
            
               return $.parseHTML(snip);
            }
            
            function getDiamondPanelElement(val) {
            
                var snip = '';
            
                snip += '<div class="panel panel-default nf-diamond-panel">';
                snip += '   <div class="panel-heading nf-diamond-heading">';
                snip += '      <img src="https://minotar.net/avatar/nf-replace-name/32" class="pull-right">';
                snip += '      <h6>Diamonds</h6>';
                snip += '   </div>';
                snip += '   <div>';
                snip += '     <img class="img-responsive" src="images/diamondbreak.jpg"/>';
                snip += '   </div>';
                snip += '   <div class="panel-body">';
                snip += '      <div class="list-group">';
                snip += '         <h3><i>nf-replace-name</i></h3>';
                snip += '         <p><i>Discovered nf-replace-block-count diamond blocks</i></p>';
                snip += '         <p class="nf-time"><i>nf-replace-time</i></p>';
                snip += '      </div">';
                snip += '   </div>';
                snip += '</div>';
            
                snip = snip.replace(/nf-replace-name/g, val.name);
                snip = snip.replace(/nf-replace-block-count/g, val.block_count);
                snip = snip.replace(/nf-replace-time/g, moment(val.time).calendar());
            
               return $.parseHTML(snip);
            }
            
            function getLevelUpPanelElement(val) {
            
                var snip = '';
            
                snip += '<div class="panel panel-default nf-mcmmo-levelup-panel">';
                snip += '   <div class="panel-heading nf-mcmmo-levelup-heading">';
                snip += '      <img src="https://minotar.net/avatar/nf-replace-name/32" class="pull-right">';
                snip += '      <h6>McMMO Level Achievement</h6>';
                snip += '   </div>';
                snip += '   <div>';
                snip += '     <img class="img-responsive" src="images/levelup.jpg"/>';
                snip += '   </div>';
                snip += '   <div class="panel-body">';
                snip += '      <div class="list-group">';
                snip += '         <div class="panel-body">';
                snip += '         <h3><i>nf-replace-name</i></h3>';
                snip += '         <p><i>Reached level nf-replace-level in nf-replace-skill</i></p>';
                snip += '         <p class="nf-time"><i>nf-replace-time</i></p>';
                snip += '      </div>';
                snip += '   </div">';
                snip += '</div>';
            
                snip = snip.replace(/nf-replace-name/g, val.name);
                snip = snip.replace(/nf-replace-skill/g, val.skill_type);
                snip = snip.replace(/nf-replace-level/g, val.level);
                snip = snip.replace(/nf-replace-time/g, moment(val.time).calendar());
            
               return $.parseHTML(snip);
            }
            
            function myFunction() {
                startIndex = endIndex;
                endIndex += 10;
                addStories(startIndex, endIndex);
            }
            
            $(function() {
                startIndex = 0;
                endIndex = 30;
            
                $('#nf-row').shuffle({
                    itemSelector: '.panel',
                    columnWidth: 267,
                    gutterWidth: 8 
                });
            
                addStories(startIndex, endIndex);
            });
            
            var addStories = function(start, end) {
                $.get( "../data/newsfeed?startindex=" + start + "&endindex=" + end, function( data ) {
                    var localPanelNode, jsonObj = JSON.parse(data), element, elementsAppended;
            
                    elementsAppended = $();
                    
                    jQuery.each(jsonObj, function(i, val) {
                        if(typeof val.news_type != 'undefined' && val.news_type == 'login') {
                            elementsAppended = elementsAppended.add(getLoginPanelElement(val));        
                        } else if(typeof val.news_type != 'undefined' && val.news_type == 'death') {
                            elementsAppended = elementsAppended.add(getDeathPanelElement(val));        
                        } else if(typeof val.news_type != 'undefined' && val.news_type == 'mcmmo_levelup') {
                            elementsAppended = elementsAppended.add(getLevelUpPanelElement(val));        
                        } else if(typeof val.news_type != 'undefined' && val.news_type == 'diamond_break') {
                            elementsAppended = elementsAppended.add(getDiamondPanelElement(val));        
                        }
                    });
                    $("#nf-row").append(elementsAppended);
                    $("#nf-row").shuffle('appended', elementsAppended);
                });  
            }

            var getDescriptiveCauseOfDeath = function(deathObj) {
                if(deathObj.killers_name != null) {
                    return "Murdered";
                } else {
                    switch(deathObj.cause_of_death) {
                        case "BLOCK_EXPLOSION": 
                            return "Explosives";
                        case "CONTACT": 
                            return "Sharp Objects";
                        case "CUSTOM":
                            return "Odd Death";
                        case "DROWNING":
                            return "Drowned";
                        case "ENTITY_ATTACK":
                            return "Mobbed!";
                        case "ENTITY_EXPLOSION":
                            return "Kaboom!";
                        case "FALL":
                            return "Long Way Down...";
                        case "FALLING_BLOCK":
                            return "Look Out Below!";
                        case "FIRE":
                            return "So Spice...";
                        case "FIRE_TICK":
                            return "Burn Baby, Burn";
                        case "LAVA":
                            return "Lava Burns";
                        case "LIGHTNING":
                            return "Electrical Death";
                        case "MAGIC":
                            return "Hocus Pocus";
                        case "MELTING":
                            return "I'm Meeelting";
                        case "POISON":
                            return "Poisoned";
                        case "PROJECTILE":
                            return "Death by Arrow";
                        case "STARVATION":
                            return "Starvation";
                        case "SUFFOCATION":
                            return "Suffocation";
                        case "SUICIDE":
                            return "Suicide";
                        case "THORNS":
                            return "Death by Thorns";
                        case "VOID":
                            return "Into the Void";
                        case "WITHER":
                            return "Withered";
                        default:
                            return "Death";
                    }
                }
            }
        </script>
    </body>
</html>
